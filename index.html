<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>å‡ºæ¬ ã‚·ã‚¹ãƒ†ãƒ </title>
<style>
body{font-family:sans-serif; padding:20px; background:#f3f4f6;}
h1{color:#1f2937;}
button{padding:10px 20px; margin:10px; border:none; background:#2563eb; color:#fff; border-radius:6px; cursor:pointer;}
button:hover{background:#1e40af;}
section{display:none;}
table{width:100%; border-collapse:collapse; background:#fff; margin-top:20px;}
th,td{border:1px solid #ddd; padding:8px; text-align:left;}
th{background:#e5e7eb;}
label{display:block; margin:6px 0;}
</style>
</head>
<body>

<!-- ãƒ›ãƒ¼ãƒ ç”»é¢ -->
<section id="home" style="display:block;">
  <h1>å­¦æ ¡ å‡ºæ¬ ã‚·ã‚¹ãƒ†ãƒ </h1>
  <button onclick="showStudent()">å‡ºå¸­ç¢ºèªï¼ˆç”Ÿå¾’ç”¨ï¼‰</button>
  <button onclick="teacherLogin()">å…ˆç”Ÿãƒ­ã‚°ã‚¤ãƒ³</button>
</section>

<!-- ç”Ÿå¾’ç”»é¢ -->
<section id="student">
  <h1>å‡ºæ¬ ç¢ºèªï¼ˆç”Ÿå¾’ç”¨ï¼‰</h1>
  <label>åå‰: <input type="text" id="studentName"></label>
  <label>å‡ºå¸­ç•ªå·: <input type="number" id="studentNumber"></label>
  <label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: <input type="password" id="studentPass"></label>

  <h3>å‡ºæ¬ é¸æŠ</h3>
  <button onclick="markAttendance('å‡ºå¸­')">å‡ºå¸­</button>
  <button onclick="showAbsenceReasons()">æ¬ å¸­</button>

  <div id="absenceReasons" style="display:none; margin-top:10px;">
    <h4>æ¬ å¸­ç†ç”±ã‚’é¸æŠã—ã¦ãã ã•ã„</h4>
    <label><input type="radio" name="reason" value="ç—…æ¬ "> ç—…æ¬ </label>
    <label><input type="radio" name="reason" value="å…¬æ¬ "> å…¬æ¬ </label>
    <label><input type="radio" name="reason" value="é…åˆ»"> é…åˆ»</label>
    <label><input type="radio" name="reason" value="æ—©é€€"> æ—©é€€</label>
    <label><input type="radio" name="reason" value="ãã®ä»–"> ãã®ä»–</label>
    <button onclick="submitAbsence()">æ¬ å¸­ã‚’è¨˜éŒ²</button>
  </div>

  <p id="result"></p>
  <button onclick="goHome()">ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
</section>

<!-- å…ˆç”Ÿç”»é¢ -->
<section id="teacher">
  <h1>å‡ºæ¬ ä¸€è¦§ï¼ˆå…ˆç”Ÿç”¨ï¼‰</h1>
  <table>
    <thead>
      <tr><th>æ—¥ä»˜</th><th>åå‰</th><th>ç•ªå·</th><th>å‡ºæ¬ </th></tr>
    </thead>
    <tbody id="attendanceList"></tbody>
  </table>
  <button onclick="goHome()">ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
</section>

<script>
// â—†ã‚µãƒ³ãƒ—ãƒ«ç”Ÿå¾’ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯åˆ¥é€”ç™»éŒ²æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã¨è‰¯ã„ï¼‰
const students = [
  {name:"ç”°ä¸­å¤ªéƒ", number:1, pass:"abc123"},
  {name:"ä½è—¤èŠ±å­", number:2, pass:"def456"},
  {name:"éˆ´æœ¨ä¸€éƒ", number:3, pass:"ghi789"}
];

// ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
function showSection(id){
  document.querySelectorAll("section").forEach(sec=>sec.style.display="none");
  document.getElementById(id).style.display="block";
}
function showStudent(){ showSection("student"); }
function showTeacher(){ loadAttendance(); showSection("teacher"); }
function goHome(){ showSection("home"); }

// ç”Ÿå¾’èªè¨¼
function authenticate(name, number, pass){
  return students.find(s=>s.name===name && s.number==number && s.pass===pass);
}

// å‡ºæ¬ è¨˜éŒ²
function markAttendance(status){
  const name = document.getElementById("studentName").value.trim();
  const number = document.getElementById("studentNumber").value.trim();
  const pass = document.getElementById("studentPass").value.trim();

  const student = authenticate(name, number, pass);
  if(!student){
    alert("èªè¨¼å¤±æ•—ï¼šåå‰ãƒ»ç•ªå·ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„");
    return;
  }

  if(status==="å‡ºå¸­"){
    saveRecord(student.name, student.number, status);
    document.getElementById("result").textContent = `âœ… ${student.name} ã•ã‚“ã‚’ã€Œ${status}ã€ã§è¨˜éŒ²ã—ã¾ã—ãŸ`;
  }
}

// æ¬ å¸­ç†ç”±ã‚’è¡¨ç¤º
function showAbsenceReasons(){
  document.getElementById("absenceReasons").style.display="block";
}

// æ¬ å¸­ã‚’é€ä¿¡
function submitAbsence(){
  const name = document.getElementById("studentName").value.trim();
  const number = document.getElementById("studentNumber").value.trim();
  const pass = document.getElementById("studentPass").value.trim();

  const student = authenticate(name, number, pass);
  if(!student){
    alert("èªè¨¼å¤±æ•—ï¼šåå‰ãƒ»ç•ªå·ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„");
    return;
  }

  const reason = document.querySelector("input[name='reason']:checked");
  if(!reason){
    alert("æ¬ å¸­ç†ç”±ã‚’é¸ã‚“ã§ãã ã•ã„");
    return;
  }

  saveRecord(student.name, student.number, "æ¬ å¸­ï¼ˆ"+reason.value+"ï¼‰");
  document.getElementById("result").textContent = `âœ… ${student.name} ã•ã‚“ã‚’ã€Œæ¬ å¸­ï¼ˆ${reason.value}ï¼‰ã€ã§è¨˜éŒ²ã—ã¾ã—ãŸ`;
  document.getElementById("absenceReasons").style.display="none";
}

// ãƒ‡ãƒ¼ã‚¿ä¿å­˜
function saveRecord(name, number, status){
  const today = new Date().toLocaleDateString();
  let records = JSON.parse(localStorage.getItem("attendance")) || [];
  records.push({date: today, name, number, status});
  localStorage.setItem("attendance", JSON.stringify(records));
}

// å…ˆç”Ÿãƒ­ã‚°ã‚¤ãƒ³
function teacherLogin(){
  const pass = prompt("å…ˆç”Ÿç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:");
  if(pass === "0018"){ showTeacher(); }
  else{ alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™"); }
}

// å‡ºæ¬ ä¸€è¦§èª­ã¿è¾¼ã¿
function loadAttendance(){
  const data = JSON.parse(localStorage.getItem("attendance")) || [];
  const tbody = document.getElementById("attendanceList");
  tbody.innerHTML = "";
  if(data.length===0){
    tbody.innerHTML = "<tr><td colspan='4'>ã¾ã å‡ºæ¬ ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>";
    return;
  }
  data.forEach(record=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${record.date}</td><td>${record.name}</td><td>${record.number}</td><td>${record.status}</td>`;
    tbody.appendChild(tr);
  });
}
</script>
</body>
</html>
